\documentclass[draftclsnofoot,onecolumn]{IEEEtran}

\usepackage{graphicx}                                        
\usepackage{amssymb}                                         
\usepackage{amsmath}                                         
\usepackage{amsthm}         


\usepackage{alltt}                                           
\usepackage{float}
\usepackage{color}
\usepackage{url}

\usepackage{balance}
\usepackage[TABBOTCAP, tight]{subfigure}
\usepackage{enumitem}
\usepackage{pstricks, pst-node}

\usepackage{geometry}


\geometry{textheight=8.5in, textwidth=6in}

%random comment

\newcommand{\cred}[1]{{\color{red}#1}}
\newcommand{\cblue}[1]{{\color{blue}#1}}

\usepackage{hyperref}
\usepackage{geometry}

\usepackage{longtable}


\newcommand{\longtableendfoot}{Please continue at the next page}

\def\name{Andrew Chase}

\date{}
\author{\name \\ 
OS II \\
Spring 2015 \\
Abstract: Describes work done to build and run a custom Memory Encrypting Disk Driver.
}
\title{Project 3: Memory Encrypting Disk Driver}

%pull in the necessary preamble matter for pygments output
\input{pygments.tex}


\begin{document}

\maketitle

\pagebreak

\tableofcontents

\pagebreak

\section{Work Log}

\begin{tabular}{ll}
  \textbf{Date} & \textbf{Work Done} \\
  May 17 & Write module, compile and test on os-class. Write helper scripts. \\
  May 18 & Fix bugs and test on os-class.\\
\end{tabular}

\section{Questions}

\subsection{The design you plan to use to implement the algorithms.}

The original plan was to use the cryptographic api exposed by Linux. The assignment gave an example device driver that contained the skeleton code needed to implement the memory disk device driver. The plan was to hook up the cryptographic primatives to that device driver such that data would be encrypted/decrypted in memory as requests were sent/received.


\subsection{What do you think the main point of this assignment is?}

I think the main point of the assignment is to use expose students to the block driver, crypto and other apis in the linux kernel and how they interact with modules. This also gives students a chance to learn about how to write custom drivers for the linux kernel. Another learning objective is exposure to the kernel memory api, which was discussed in class.

\subsection{How did you personally approach the problem? Design decisions, algorithm, etc.}

As before first I went out and sought other people's solutions to the problems. I read through them carefully and tried to figure out how they worked and what apis were used. I learned a lot from reading examples. Another thing I did was look deeply into the Linux kernel source code to try and figure out how the cryptographic primitives were supposed to be used.

I used the standard synchronous block api, with the one-block-at-a-time functions. The crypto function I used was AES.

\subsection{How did you ensure your solution was correct? Testing details, for instance.}

I inserted kprint calls and ran the kernel in the emulator. The kprint calls recorded the sector number.

Example:

\begin{verbatim}
Reading from memdiskblk --
Encrypted data: 000
Decrypted data: 001c
Reading from memdiskblk --
Encrypted data: 20ffffffa8ffffffc5
\end{verbatim}

The testing helped because the first solution I had implemented wasn't correct and it was pretty obvious to see from the kernel messages. At first, my module didn't load, and using dmesg | grep I was able to find the error message to fix the problem.

\subsection{What did you learn?}

I learned a bit about how linux driver system works, how to compile and load modules into the linux kernel with parameters. I also learned that the linux kernel exposes a robust crypto api that can be easily integrated to add cryptographic primitives to drivers in the linux kernel. I also learned how to debug buggy kernel modules using dmesg and gdb.

\section{Concurrency Exercise: Git Log}

%% This file was generated by the script latex-git-log
\begin{tabular}{lp{20cm}}
  \label{tabular:legend:git-log}
  \textbf{acronym} & \textbf{meaning} \\
  V & \texttt{version} \\
  tag & \texttt{git tag} \\
  MF & Number of \texttt{modified files}. \\
  AL & Number of \texttt{added lines}. \\
  DL & Number of \texttt{deleted lines}. \\
\end{tabular}

\bigskip

\iflanguage{ngerman}{\shorthandoff{"}}{}
\begin{longtable}{|rlllrrr|}
\hline \multicolumn{1}{|c}{\textbf{V}} & \multicolumn{1}{c}{\textbf{tag}}
& \multicolumn{1}{c}{\textbf{date}}
& \multicolumn{1}{c}{\textbf{commit message}} & \multicolumn{1}{c}{\textbf{MF}}
& \multicolumn{1}{c}{\textbf{AL}} & \multicolumn{1}{c|}{\textbf{DL}} \\ \hline
\endhead

\hline \multicolumn{7}{|r|}{\longtableendfoot} \\ \hline
\endfoot

\hline% \hline
\endlastfoot

\hline 1 &  & 2016-05-18 & init & 0 & 191 & 0 \\
\end{longtable}


\section{Code Listing}

\subsection{memdiskblk.c}

\input{memdiskblk.tex}

\end{document}
